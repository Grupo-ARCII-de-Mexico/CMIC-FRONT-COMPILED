"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7648],{7648:(me,X,l)=>{l.r(X),l.d(X,{VerLicitacionesPageModule:()=>re});var K=l(6814),ne=l(95),u=l(9843),m=l(9085),f=l(5861),y=l(1486),$=l(6676),e=l(6689),ie=l(2338),te=l(930),oe=l(4433),le=l(7153),ce=l(2425);function ae(o,d){if(1&o){const c=e.EpF();e.TgZ(0,"tr")(1,"th",15),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"ion-buttons",16)(9,"ion-button",17),e._UZ(10,"ion-icon",18),e.qZA(),e.TgZ(11,"ion-button",19),e.NdJ("click",function(){const s=e.CHM(c).$implicit,a=e.oxw();return e.KtG(a.deleteEvento(s.id))}),e._UZ(12,"ion-icon",20),e.qZA()()()()}if(2&o){const c=d.$implicit;e.xp6(2),e.hij(" ",c.codigoContrato," "),e.xp6(2),e.Oqu(c.noProcedimiento),e.xp6(2),e.Oqu(c.dependencia),e.xp6(3),e.MGl("routerLink","editar-licitaciones/",c.id,"")}}const se=function(){return["/dashboard/licitaciones/crear-licitaciones"]},ue=[{path:"",component:(()=>{var o;class d{constructor(t,i,s,a,r){this.licitacionRepo=t,this.genericService=i,this.alert=s,this.loading=a,this.toast=r,this.licitaciones=[],this.licitacionesToCreate=[]}ngOnInit(){this.licitacionRepo.licitaciones$.subscribe(t=>{this.licitaciones=t})}mon(t){return $(t).locale("es").format("L")+" "+$(new Date(t)).utc().format("LTS")}deleteEvento(t){var i=this;return(0,f.Z)(function*(){var s;yield i.alert.setData({animated:!0,header:"Est\xe1 a punto de eliminar esta licitaci\xf3n",message:"Si lo elimina se perder\xe1n todos los datos relacionados. \n \xbfDesea continuar?",buttons:[{text:"Cancelar"},{text:"Confirmar",handler:(s=(0,f.Z)(function*(){i.loading.setData({animated:!0,message:"Eliminando",spinner:"dots"}),yield i.loading.create(),yield i.loading.show(),i.genericService.delete("licitaciones",t).subscribe(function(){var a=(0,f.Z)(function*(r){yield i.loading.hide(),i.toast.success("Licitaci\xf3n Eliminada"),i.licitacionRepo.deleteLicitacion(t)});return function(r){return a.apply(this,arguments)}}())}),function(){return s.apply(this,arguments)})}]})})()}onFileSelected(t){var i=this;return(0,f.Z)(function*(){if(i.loading.setData({animated:!0,message:"Cargando licitaciones",spinner:"dots"}),yield i.loading.create(),yield i.loading.show(),i.file={documento:"file",uri:t.target.files[0]},i.file){const s=new FileReader;s.onload=function(){var a=(0,f.Z)(function*(r){const _=y.ij(r.target.result,{type:"binary"});let g=y.P6.sheet_to_json(_.Sheets[_.SheetNames[0]],{header:1});g=g.filter(n=>n.some(W=>null!=W&&""!==W)),g.shift();for(let n of g){var h,v,Z,P,A,L,x,C,T,b,D,F,w,V,U,M,S,J,E,I,O,j,R,k,B,N,Y,G,Q,q,z,H;i.licitacionesToCreate.push({claveExpediente:null!==(h=n[0])&&void 0!==h?h:null,codigoContrato:null!==(v=n[1])&&void 0!==v?v:null,noProcedimiento:null!==(Z=n[2])&&void 0!==Z?Z:null,dependencia:null!==(P=n[3])&&void 0!==P?P:null,unidadCompradora:null!==(A=n[4])&&void 0!==A?A:null,descripcionObra:null!==(L=n[5])&&void 0!==L?L:null,tipoContratacion:null!==(x=n[6])&&void 0!==x?x:null,caracter:null!==(C=n[7])&&void 0!==C?C:null,modalidad:null!==(T=n[8])&&void 0!==T?T:null,procedenciaRecursos:null!==(b=n[9])&&void 0!==b?b:null,origenRecursos:null!==(D=n[10])&&void 0!==D?D:null,programasEspeciales:null!==(F=n[11])&&void 0!==F?F:null,fechaPublicacion:"-"!==n[12]?new Date(24*(n[12]-1)*60*60*1e3):void 0,fechaPresentacionPropuestaProgramada:"-"!==n[13]?new Date(24*(n[13]-1)*60*60*1e3):void 0,fechaPresentacionPropuesta:"-"!==n[14]?new Date(24*(n[14]-1)*60*60*1e3):void 0,fechaFalloProgramada:"-"!==n[15]?new Date(24*(n[15]-1)*60*60*1e3):void 0,fechaFallo:"-"!==n[16]?new Date(24*(n[16]-1)*60*60*1e3):void 0,estatusProcedimiento:null!==(w=n[17])&&void 0!==w?w:null,empresaGanadora:null!==(V=n[18])&&void 0!==V?V:null,importeAdjudicado:null!==(U=n[19])&&void 0!==U?U:null,fechaInicioContrato:"-"!==n[38]?new Date(24*(n[38]-1)*60*60*1e3):void 0,fechaFinContrato:"-"!==n[38]?new Date(24*(n[38]-1)*60*60*1e3):void 0,lugarVenta:null!==(M=n[22])&&void 0!==M?M:null,domicilioVenta:null!==(S=n[23])&&void 0!==S?S:null,fechaInicio1:"-"!==n[24]?new Date(24*(n[24]-1)*60*60*1e3):void 0,fechaFin1:"-"!==n[25]?new Date(24*(n[25]-1)*60*60*1e3):void 0,fechaInicio2:"-"!==n[26]?new Date(24*(n[26]-1)*60*60*1e3):void 0,fechaFin2:"-"!==n[27]?new Date(24*(n[27]-1)*60*60*1e3):void 0,fechaInicio3:"-"!==n[28]?new Date(24*(n[28]-1)*60*60*1e3):void 0,fechaFin3:"-"!==n[29]?new Date(24*(n[29]-1)*60*60*1e3):void 0,fechaInicio4:"-"!==n[30]?new Date(24*(n[30]-1)*60*60*1e3):void 0,fechaFin4:"-"!==n[31]?new Date(24*(n[31]-1)*60*60*1e3):void 0,fechaInicio5:"-"!==n[32]?new Date(24*(n[32]-1)*60*60*1e3):void 0,fechaFin5:"-"!==n[33]?new Date(24*(n[33]-1)*60*60*1e3):void 0,formaPago:null!==(J=n[34])&&void 0!==J?J:null,datosPago:null!==(E=n[35])&&void 0!==E?E:null,lugarJuntaAclaraciones:null!==(I=n[36])&&void 0!==I?I:null,direccionJuntaAclaracion:null!==(O=n[37])&&void 0!==O?O:null,fechaJuntaAclaraciones:"-"!==n[38]?new Date(24*(n[38]-1)*60*60*1e3):void 0,MontoFiniquitoContrato:null!==(j=n[39])&&void 0!==j?j:null,plazoEjecucion:null!==(R=n[40])&&void 0!==R?R:null,municipio:null!==(k=n[41])&&void 0!==k?k:null,noAfiliado:null!==(B=n[42])&&void 0!==B?B:null,ultimoAnoAfiliacion:null!==(N=n[43])&&void 0!==N?N:null,delegacion:null!==(Y=n[44])&&void 0!==Y?Y:null,esAfiliado:"-"!==n[45],montoAfiliado:null!==(G=n[46])&&void 0!==G?G:null,montoNoAfiliado:null!==(Q=n[47])&&void 0!==Q?Q:null,montoBajo:null!==(q=n[48])&&void 0!==q?q:null,montoAlto:null!==(z=n[49])&&void 0!==z?z:null,lugarGanadorApertura:null!==(H=n[50])&&void 0!==H?H:null,esExtranjera:"-"!==n[51]})}const ee=[];for(let n=0;n<i.licitacionesToCreate.length;n+=100)ee.push(i.licitacionesToCreate.slice(n,n+100));yield i.loading.hide(),yield i.alertMassiveUpload(ee)});return function(r){return a.apply(this,arguments)}}(),s.readAsBinaryString(i.file.uri)}})()}click(t){document.getElementById(t).click()}alertMassiveUpload(t){var i=this;return(0,f.Z)(function*(){var s;yield i.alert.setData({animated:!0,header:"Se van a subir "+i.licitacionesToCreate.length+" licitaciones",message:"Esto puede tomar un tiempo \xbfDesea Continuar?",buttons:[{text:"Cancelar"},{text:"Cargar Licitaciones",handler:(s=(0,f.Z)(function*(){i.loading.setData({animated:!0,message:"Subiendo Licitaciones espere...",spinner:"dots"}),yield i.loading.create(),yield i.loading.show();for(const a of t){const r=yield i.genericService.post("licitaciones/massive",a).toPromise(),p=[...i.licitaciones,...r||[]];i.licitacionRepo.setLicitacion(p)}i.toast.success("Licitaciones Guardadas"),yield i.loading.hide(),i.file=void 0}),function(){return s.apply(this,arguments)})}]})})()}}return(o=d).\u0275fac=function(t){return new(t||o)(e.Y36(ie.X),e.Y36(te.M),e.Y36(oe.c),e.Y36(le.b),e.Y36(ce._W))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-ver-licitaciones"]],decls:32,vars:7,consts:[[3,"fullscreen"],["color","dark",1,"py-2"],[1,"ms-2","ms-md-5","mb-0","titulo"],[1,"palito","ms-2","ms-md-5","mt-0","mb-3"],["slot","end","shape","round","expand","block",1,"mx-1","mt-2",3,"color","click"],["id","in","type","file","accept",".xls, .cvc, .xlsx",2,"display","none",3,"change"],["slot","end","routerLinkActive","router-link-active","shape","round",1,"mx-1","mt-2",3,"routerLink"],[1,"mt-1","px-3"],[1,"container"],[1,"d-flex","mt-5"],["placeholder","Buscar licitaci\xf3n","inputmode","text","type","text",1,"ms-auto","me-3","my-0","w-100",3,"debounce"],[1,"table","mt-0"],[1,"red"],["scope","col",1,"red"],[4,"ngFor","ngForOf"],["scope","row",1,"text-center"],["color","primary","slot","start"],["color","primary",3,"routerLink"],["slot","icon-only","name","create-outline"],["color","primary",3,"click"],["slot","icon-only","name","trash-outline"]],template:function(t,i){1&t&&(e.TgZ(0,"ion-content",0),e._UZ(1,"br"),e.TgZ(2,"ion-toolbar",1),e._UZ(3,"br"),e.TgZ(4,"h1",2)(5,"b"),e._uU(6," Licitaciones"),e.qZA()(),e._UZ(7,"hr",3),e.TgZ(8,"ion-button",4),e.NdJ("click",function(){return i.click("in")}),e.TgZ(9,"ion-label"),e._uU(10),e.qZA(),e.TgZ(11,"input",5),e.NdJ("change",function(a){return i.onFileSelected(a)}),e.qZA()(),e.TgZ(12,"ion-button",6),e._uU(13," Crear Licitaci\xf3n "),e.qZA()(),e.TgZ(14,"div",7)(15,"div",8)(16,"div",9),e._UZ(17,"hr")(18,"ion-searchbar",10),e.qZA(),e.TgZ(19,"table",11)(20,"thead",12)(21,"tr")(22,"th",13),e._uU(23,"No. Contrato"),e.qZA(),e.TgZ(24,"th",13),e._uU(25,"No. Procedimiento"),e.qZA(),e.TgZ(26,"th",13),e._uU(27,"Dependencia"),e.qZA(),e.TgZ(28,"th",13),e._uU(29,"Opciones"),e.qZA()()(),e.TgZ(30,"tbody"),e.YNc(31,ae,13,4,"tr",14),e.qZA()()()()()),2&t&&(e.Q6J("fullscreen",!0),e.xp6(8),e.Q6J("color",null!=i.file&&i.file.uri?"success":"primary"),e.xp6(2),e.Oqu(null!=i.file&&i.file.uri?"Archivo Cargado":"Subir Licitaciones"),e.xp6(2),e.Q6J("routerLink",e.DdM(6,se)),e.xp6(6),e.Q6J("debounce",250),e.xp6(13),e.Q6J("ngForOf",i.licitaciones))},dependencies:[K.sg,u.YG,u.Sm,u.W2,u.gu,u.Q$,u.VI,u.sr,u.j9,u.YI,m.rH,m.Od],styles:["ion-searchbar[_ngcontent-%COMP%]{width:250px;border-radius:15px!important;border-start-end-radius:10px}ion-img[_ngcontent-%COMP%]{width:150px}.red[_ngcontent-%COMP%]{background-color:red;color:#fff}"]}),d})()}];let de=(()=>{var o;class d{}return(o=d).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[m.Bz.forChild(ue),m.Bz]}),d})(),re=(()=>{var o;class d{}return(o=d).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[K.ez,ne.u5,u.Pc,de]}),d})()}}]);