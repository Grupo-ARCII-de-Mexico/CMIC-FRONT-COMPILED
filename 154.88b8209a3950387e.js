"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[154],{154:(w,Z,c)=>{c.r(Z),c.d(Z,{CrearOportunidadPageModule:()=>Q});var h=c(6814),m=c(95),s=c(9843),f=c(9085),p=c(5861),g=c(8915),v=c(4664),b=c(9397),C=c(553),e=c(6689),x=c(7153),O=c(2425),T=c(2264),P=c(930),y=c(5368);function M(n,d){if(1&n&&e._UZ(0,"ion-img",22),2&n){const t=e.oxw();e.Q6J("src",t.logotipo)}}function J(n,d){1&n&&(e.TgZ(0,"h5",23)(1,"b"),e._uU(2,"Documentos Agregados"),e.qZA()())}function A(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.TgZ(3,"p"),e._uU(4),e.qZA()(),e.TgZ(5,"ion-button",24),e.NdJ("click",function(){const a=e.CHM(t).index,r=e.oxw();return e.KtG(r.eliminarDocumentos(a))}),e._UZ(6,"ion-icon",25),e.qZA()()}if(2&n){const t=d.$implicit;e.xp6(2),e.hij(" ",t.texto," "),e.xp6(2),e.Oqu(t.descripcion)}}function N(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"ion-item")(1,"ion-label"),e._uU(2),e.qZA(),e.TgZ(3,"ion-button",24),e.NdJ("click",function(){const a=e.CHM(t).index,r=e.oxw();return e.KtG(r.eliminar(a))}),e._UZ(4,"ion-icon",25),e.qZA()()}if(2&n){const t=d.$implicit;e.xp6(2),e.Oqu(t)}}function I(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"ion-button",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.download(i.documentoOpcional))}),e._UZ(1,"ion-icon",27),e.qZA()}}function k(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"ion-button",28),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.click())}),e.TgZ(1,"ion-label"),e._uU(2,"Seleccionar archivo"),e.qZA(),e.TgZ(3,"input",29),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.onFileSelected(i))}),e.qZA()()}}function F(n,d){if(1&n){const t=e.EpF();e.TgZ(0,"ion-button",30),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.click())}),e.TgZ(1,"ion-label"),e._uU(2),e.qZA(),e.TgZ(3,"input",29),e.NdJ("change",function(i){e.CHM(t);const a=e.oxw();return e.KtG(a.onFileSelected(i))}),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("color",t.documentoOpcional?"success":"primary"),e.xp6(2),e.Oqu(t.documentoOpcional?"Archivo Cargado":"Seleccionar archivo")}}const U=[{path:"",component:(()=>{var n;class d{constructor(o,i,a,r,l,u,_){this.loading=o,this.toast=i,this.compressImage=a,this.genericService=r,this.active=l,this.negocio=u,this.nav=_,this.empresa="",this.toolbar=[[{heading:["h1","h2","h3","h4","h5","h6"]}],["bold","italic"],["underline","strike"],["ordered_list","bullet_list"],["align_left","align_center","align_right","align_justify"],["horizontal_rule","format_clear"],["text_color","background_color"]],this.edit=!1,this.documentos=[],this.especialidades=[],this.uri=C.N.image+"oportunidades-logotipos/",this.uriDoc=C.N.image+"oportunidades-documentoInformativo/",this.especialidad="",this.document={texto:"",descripcion:""},this.convocatoria=""}ngOnInit(){this.editor=new g.ML,this.active.params.pipe((0,v.w)(o=>(o.identificador&&(this.edit=!0,this.identificador=o.identificador),this.negocio.negocio$))).subscribe(o=>{if(this.edit){const i=o.find(a=>a.id===Number(this.identificador));i?(console.log(i),this.documentos=i.documentos,this.especialidades=i.especialidades,this.empresa=i.empresa,this.logotipo=i.logotipo?this.uri+i.logotipo:null,this.documentoOpcional=i.documento?this.uriDoc+i.documento:null,this.convocatoria=i.convocatoria):this.nav.navigateForward("/dashboard/negocios")}})}uploadImage(){var o=this;return(0,p.Z)(function*(){o.logotipo=yield o.compressImage.returnImageCompress()})()}agregarEspecialidad(){this.especialidades.push(this.especialidad),this.especialidad=""}eliminar(o){this.especialidades.splice(o,1)}agregarDocumentos(){this.documentos.push(this.document),this.document={texto:"",descripcion:""}}eliminarDocumentos(o){this.documentos.splice(o,1)}save(){var o=this;return(0,p.Z)(function*(){if(o.edit)return void(yield o.editNegocio());o.loading.setData({animated:!0,message:"Subiendo...",spinner:"dots"}),yield o.loading.create(),yield o.loading.show();const i=new FormData;i.append("logotipo",o.compressImage.dataURItoBlob(o.logotipo)),o.genericService.postWhitImage("negocio",i).pipe((0,v.w)(function(){var a=(0,p.Z)(function*(r){let l;if(l="string"!=typeof o.convocatoria?(0,g.io)(o.convocatoria):o.convocatoria,o.documentoOpcional){const u=new FormData;u.append("documento",o.documentoOpcional),yield o.genericService.updateWhitImage("negocio",r.id,u).toPromise()}return o.genericService.update("negocio",r.id,{especialidades:o.especialidades,documentos:o.documentos,empresa:o.empresa,convocatoria:l}).toPromise()});return function(r){return a.apply(this,arguments)}}()),(0,b.b)(function(){var a=(0,p.Z)(function*(r){console.log(r),o.empresa="",o.logotipo=null,o.especialidad="",o.especialidades=[],o.documentos=[],o.document={texto:"",descripcion:""},o.convocatoria="",o.documentoOpcional=null,yield o.loading.hide(),o.toast.success("Nueva Oportunidad de Negocio","Creada")});return function(r){return a.apply(this,arguments)}}())).subscribe()})()}onFileSelected(o){this.documentoOpcional=o.target.files[0],o.target.value=""}click(){document.getElementById("opcional").click()}editNegocio(){var o=this;return(0,p.Z)(function*(){var i;o.loading.setData({animated:!0,message:"Actualizando...",spinner:"dots"}),yield o.loading.create(),yield o.loading.show();const a=new FormData;o.logotipo&&!(null!==(i=o.logotipo)&&void 0!==i&&i.includes(o.uri))&&a.append("logotipo",o.compressImage.dataURItoBlob(o.logotipo)),o.genericService.update("negocio",Number(o.identificador),a).pipe((0,v.w)(function(){var r=(0,p.Z)(function*(l){let u;if(u="string"!=typeof o.convocatoria?(0,g.io)(o.convocatoria):o.convocatoria,o.documentoOpcional&&"string"!=typeof o.documentoOpcional){const _=new FormData;_.append("documento",o.documentoOpcional),yield o.genericService.updateWhitImage("negocio",l.id,_).toPromise()}return o.genericService.update("negocio",l.id,{especialidades:o.especialidades,documentos:o.documentos,empresa:o.empresa,convocatoria:u}).toPromise()});return function(l){return r.apply(this,arguments)}}()),(0,b.b)(function(){var r=(0,p.Z)(function*(l){o.empresa="",o.logotipo=null,o.especialidad="",o.especialidades=[],o.documentos=[],o.document={texto:"",descripcion:""},o.convocatoria="",o.documentoOpcional=null,yield o.loading.hide(),o.toast.success("Oportunidad de Negocio","Actualizada"),o.negocio.updateNegocio(l.id,l),o.nav.navigateForward("/dashboard/negocios")});return function(l){return r.apply(this,arguments)}}())).subscribe()})()}download(o){const i=document.createElement("a");i.href=o,i.download=o,document.body.appendChild(i),i.click(),document.body.removeChild(i)}valid(){var o;return"string"==typeof this.documentoOpcional&&this.edit&&(null===(o=this.documentoOpcional)||void 0===o?void 0:o.includes(this.uriDoc))}}return(n=d).\u0275fac=function(o){return new(o||n)(e.Y36(x.b),e.Y36(O._W),e.Y36(T.Y),e.Y36(P.M),e.Y36(f.gz),e.Y36(y.v),e.Y36(s.SH))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-crear-oportunidad"]],decls:53,vars:22,consts:[[3,"fullscreen"],[1,"mt-5","px-3"],[1,"container"],[1,"my-3"],["button","",3,"click"],["style","max-width: 200px; max-height: 330px;",3,"src",4,"ngIf"],["type","text","labelPlacement","floating","label","Nombre de la empresa",3,"ngModel","ngModelChange"],["type","text","labelPlacement","floating","label","Ingrese Nombre del Documento",3,"ngModel","ngModelChange"],["slot","end",3,"disabled","click"],["slot","icon-only","name","add"],["labelPlacement","floating","label","Ingrese Descripci\xf3n",3,"ngModel","ngModelChange"],["class","my-2",4,"ngIf"],[4,"ngFor","ngForOf"],["type","text","labelPlacement","floating","label","Ingrese Especialidad",3,"ngModel","ngModelChange"],[1,"NgxEditor__Wrapper"],[3,"toolbar","editor"],[3,"editor","ngModel","placeholder","ngModelChange"],["color","danger"],["slot","start","fill","clear",3,"click",4,"ngIf"],["expand","block","fill","clear","slot","end",3,"click",4,"ngIf"],["expand","block","fill","clear","slot","end",3,"color","click",4,"ngIf"],["expand","block","shape","round",1,"my-3",3,"disabled","click"],[2,"max-width","200px","max-height","330px",3,"src"],[1,"my-2"],["slot","end",3,"click"],["slot","icon-only","name","close"],["slot","start","fill","clear",3,"click"],["slot","icon-only","name","download-outline"],["expand","block","fill","clear","slot","end",3,"click"],["id","opcional","type","file","accept",".pdf",2,"display","none",3,"change"],["expand","block","fill","clear","slot","end",3,"color","click"]],template:function(o,i){1&o&&(e.TgZ(0,"ion-content",0),e._UZ(1,"br")(2,"br"),e.TgZ(3,"div",1)(4,"div",2)(5,"h1",3)(6,"b"),e._uU(7),e.qZA()(),e.TgZ(8,"div",2)(9,"ion-item",4),e.NdJ("click",function(){return i.uploadImage()}),e.TgZ(10,"ion-label"),e._uU(11,"Subir Imagen"),e.qZA(),e.YNc(12,M,1,1,"ion-img",5),e.qZA(),e.TgZ(13,"ion-item")(14,"ion-input",6),e.NdJ("ngModelChange",function(r){return i.empresa=r}),e.qZA()(),e.TgZ(15,"h3",3)(16,"b"),e._uU(17,"Agregar Documentos"),e.qZA()(),e.TgZ(18,"ion-item")(19,"ion-input",7),e.NdJ("ngModelChange",function(r){return i.document.texto=r}),e.qZA(),e.TgZ(20,"ion-button",8),e.NdJ("click",function(){return i.agregarDocumentos()}),e._UZ(21,"ion-icon",9),e.qZA()(),e.TgZ(22,"ion-item")(23,"ion-textarea",10),e.NdJ("ngModelChange",function(r){return i.document.descripcion=r}),e.qZA()(),e.YNc(24,J,3,0,"h5",11),e.YNc(25,A,7,2,"ion-item",12),e.TgZ(26,"h3",3)(27,"b"),e._uU(28,"Agregar Especialidades"),e.qZA()(),e.TgZ(29,"ion-item")(30,"ion-input",13),e.NdJ("ngModelChange",function(r){return i.especialidad=r}),e.qZA(),e.TgZ(31,"ion-button",8),e.NdJ("click",function(){return i.agregarEspecialidad()}),e._UZ(32,"ion-icon",9),e.qZA()(),e.YNc(33,N,5,1,"ion-item",12),e.qZA()(),e.TgZ(34,"div",2)(35,"h3",3)(36,"b"),e._uU(37,"Informaci\xf3n Adicional "),e.qZA()(),e.TgZ(38,"div",14),e._UZ(39,"ngx-editor-menu",15),e.TgZ(40,"ngx-editor",16),e.NdJ("ngModelChange",function(r){return i.convocatoria=r}),e.qZA()(),e.TgZ(41,"ion-item")(42,"ion-label"),e._uU(43," PDF con informaci\xf3n adicional"),e.TgZ(44,"ion-text",17),e._uU(45," * "),e.qZA(),e.TgZ(46,"p"),e._uU(47,"(formato PDF)"),e.qZA()(),e.YNc(48,I,2,0,"ion-button",18),e.YNc(49,k,4,0,"ion-button",19),e.YNc(50,F,4,2,"ion-button",20),e.qZA(),e.TgZ(51,"ion-button",21),e.NdJ("click",function(){return i.save()}),e._uU(52),e.qZA()()()()),2&o&&(e.Q6J("fullscreen",!0),e.xp6(7),e.hij("",i.edit?"Editar":"Crear"," Oportunidad de Negocio"),e.xp6(5),e.Q6J("ngIf",i.logotipo),e.xp6(2),e.Q6J("ngModel",i.empresa),e.xp6(5),e.Q6J("ngModel",i.document.texto),e.xp6(1),e.Q6J("disabled",""===i.document.texto),e.xp6(3),e.Q6J("ngModel",i.document.descripcion),e.xp6(1),e.Q6J("ngIf",i.documentos.length>0),e.xp6(1),e.Q6J("ngForOf",i.documentos),e.xp6(5),e.Q6J("ngModel",i.especialidad),e.xp6(1),e.Q6J("disabled",!i.especialidad||""===i.especialidad),e.xp6(2),e.Q6J("ngForOf",i.especialidades),e.xp6(6),e.Q6J("toolbar",i.toolbar)("editor",i.editor),e.xp6(1),e.Q6J("editor",i.editor)("ngModel",i.convocatoria)("placeholder","Descripci\xf3n del evento"),e.xp6(8),e.Q6J("ngIf",i.valid()),e.xp6(1),e.Q6J("ngIf",i.edit),e.xp6(1),e.Q6J("ngIf",!i.edit),e.xp6(1),e.Q6J("disabled",!i.logotipo||""===i.empresa),e.xp6(1),e.hij(" ",i.edit?"Actualizar":"Crear"," "))},dependencies:[h.sg,h.O5,m.JJ,m.On,s.YG,s.W2,s.gu,s.Xz,s.pK,s.Ie,s.Q$,s.yW,s.g2,s.j9,g.tP,g.Mn]}),d})()}];let D=(()=>{var n;class d{}return(n=d).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[f.Bz.forChild(U),f.Bz]}),d})(),Q=(()=>{var n;class d{}return(n=d).\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[h.ez,m.u5,m.UX,s.Pc,g.FP,D]}),d})()}}]);