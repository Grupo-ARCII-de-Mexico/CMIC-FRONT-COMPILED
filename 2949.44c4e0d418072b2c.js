"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2949],{2949:(Pe,y,s)=>{s.r(y),s.d(y,{VerLicitacionesPageModule:()=>Ze});var h=s(6814),v=s(95),g=s(9843),p=s(9085),f=s(5861),_=s(1486),$=s(6676),e=s(6689),te=s(2338),oe=s(930),le=s(4433),ce=s(7153),ae=s(2425),ee=s(7602),se=s(6991);let de=(()=>{var t;class d{transform(o,n){const a=[];if(!n)return o;if(o)for(const r of o){var c,u;(null==r||null===(c=r.codigoContrato)||void 0===c?void 0:c.toLowerCase().indexOf(n.toLowerCase()))>-1&&a.push(r),(null==r||null===(u=r.noProcedimiento)||void 0===u?void 0:u.toLowerCase().indexOf(n.toLowerCase()))>-1&&a.push(r)}return(0,se.o)(a)}}return(t=d).\u0275fac=function(o){return new(o||t)},t.\u0275pipe=e.Yjl({name:"licitacionSearch",type:t,pure:!0}),d})();function ue(t,d){if(1&t){const l=e.EpF();e.TgZ(0,"tr")(1,"th",17),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"ion-buttons",18)(9,"ion-button",19),e._UZ(10,"ion-icon",20),e.qZA(),e.TgZ(11,"ion-button",21),e.NdJ("click",function(){const a=e.CHM(l).$implicit,c=e.oxw(2);return e.KtG(c.deleteEvento(a.id))}),e._UZ(12,"ion-icon",22),e.qZA()()()()}if(2&t){const l=d.$implicit;e.xp6(2),e.hij(" ",l.codigoContrato," "),e.xp6(2),e.Oqu(l.noProcedimiento),e.xp6(2),e.Oqu(l.dependencia),e.xp6(3),e.MGl("routerLink","editar-licitaciones/",l.id,"")}}function re(t,d){if(1&t&&(e.TgZ(0,"tbody"),e.YNc(1,ue,13,4,"tr",16),e.ALo(2,"licitacionSearch"),e.qZA()),2&t){const l=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,l.licitaciones.slice(l.pagina*l.divisor,(l.pagina+1)*l.divisor),l.search))}}function ge(t,d){if(1&t){const l=e.EpF();e.TgZ(0,"tr")(1,"th",17),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td")(8,"ion-buttons",18)(9,"ion-button",19),e._UZ(10,"ion-icon",20),e.qZA(),e.TgZ(11,"ion-button",21),e.NdJ("click",function(){const a=e.CHM(l).$implicit,c=e.oxw(2);return e.KtG(c.deleteEvento(a.id))}),e._UZ(12,"ion-icon",22),e.qZA()()()()}if(2&t){const l=d.$implicit;e.xp6(2),e.hij(" ",l.codigoContrato," "),e.xp6(2),e.Oqu(l.noProcedimiento),e.xp6(2),e.Oqu(l.dependencia),e.xp6(3),e.MGl("routerLink","editar-licitaciones/",l.id,"")}}function fe(t,d){if(1&t&&(e.TgZ(0,"tbody"),e.YNc(1,ge,13,4,"tr",16),e.qZA()),2&t){const l=e.oxw();e.xp6(1),e.Q6J("ngForOf",l.licitacionesSelected)}}const pe=function(){return["/dashboard/licitaciones/crear-licitaciones"]},me=[{path:"",component:(()=>{var t;class d{constructor(o,n,a,c,u){this.licitacionRepo=o,this.genericService=n,this.alert=a,this.loading=c,this.toast=u,this.licitaciones=[],this.licitacionesToCreate=[],this.licitacionesSelected=[],this.divisor=15,this.pagina=0}ngOnInit(){this.licitacionRepo.licitaciones$.subscribe(o=>{this.licitaciones=o,this.licitacionesSelected=o.slice(0,this.divisor)})}mon(o){return $(o).locale("es").format("L")+" "+$(new Date(o)).utc().format("LTS")}deleteEvento(o){var n=this;return(0,f.Z)(function*(){var a;yield n.alert.setData({animated:!0,header:"Est\xe1 a punto de eliminar esta licitaci\xf3n",message:"Si lo elimina se perder\xe1n todos los datos relacionados. \n \xbfDesea continuar?",buttons:[{text:"Cancelar"},{text:"Confirmar",handler:(a=(0,f.Z)(function*(){n.loading.setData({animated:!0,message:"Eliminando",spinner:"dots"}),yield n.loading.create(),yield n.loading.show(),n.genericService.delete("licitaciones",o).subscribe(function(){var c=(0,f.Z)(function*(u){yield n.loading.hide(),n.toast.success("Licitaci\xf3n Eliminada"),n.licitacionRepo.deleteLicitacion(o)});return function(u){return c.apply(this,arguments)}}())}),function(){return a.apply(this,arguments)})}]})})()}onFileSelected(o){var n=this;return(0,f.Z)(function*(){if(n.loading.setData({animated:!0,message:"Cargando licitaciones",spinner:"dots"}),yield n.loading.create(),yield n.loading.show(),n.file={documento:"file",uri:o.target.files[0]},n.file){const a=new FileReader;a.onload=function(){var c=(0,f.Z)(function*(u){const ie=_.ij(u.target.result,{type:"binary"});let m=_.P6.sheet_to_json(ie.Sheets[ie.SheetNames[0]],{header:1});m=m.filter(i=>i.some(X=>null!=X&&""!==X)),m.shift();for(let i of m){var Z,L,P,x,T,A,C,b,D,F,M,V,w,S,U,J,O,I,E,N,j,q,Y,R,Q,G,k,B,z,H,K,W;n.licitacionesToCreate.push({claveExpediente:null!==(Z=i[0])&&void 0!==Z?Z:null,codigoContrato:null!==(L=i[1])&&void 0!==L?L:null,noProcedimiento:null!==(P=i[2])&&void 0!==P?P:null,dependencia:null!==(x=i[3])&&void 0!==x?x:null,unidadCompradora:null!==(T=i[4])&&void 0!==T?T:null,descripcionObra:null!==(A=i[5])&&void 0!==A?A:null,tipoContratacion:null!==(C=i[6])&&void 0!==C?C:null,caracter:null!==(b=i[7])&&void 0!==b?b:null,modalidad:null!==(D=i[8])&&void 0!==D?D:null,procedenciaRecursos:null!==(F=i[9])&&void 0!==F?F:null,origenRecursos:null!==(M=i[10])&&void 0!==M?M:null,programasEspeciales:null!==(V=i[11])&&void 0!==V?V:null,fechaPublicacion:"-"!==i[12]?new Date(24*(i[12]-1)*60*60*1e3):void 0,fechaPresentacionPropuestaProgramada:"-"!==i[13]?new Date(24*(i[13]-1)*60*60*1e3):void 0,fechaPresentacionPropuesta:"-"!==i[14]?new Date(24*(i[14]-1)*60*60*1e3):void 0,fechaFalloProgramada:"-"!==i[15]?new Date(24*(i[15]-1)*60*60*1e3):void 0,fechaFallo:"-"!==i[16]?new Date(24*(i[16]-1)*60*60*1e3):void 0,estatusProcedimiento:null!==(w=i[17])&&void 0!==w?w:null,empresaGanadora:null!==(S=i[18])&&void 0!==S?S:null,importeAdjudicado:null!==(U=i[19])&&void 0!==U?U:null,fechaInicioContrato:"-"!==i[38]?new Date(24*(i[38]-1)*60*60*1e3):void 0,fechaFinContrato:"-"!==i[38]?new Date(24*(i[38]-1)*60*60*1e3):void 0,lugarVenta:null!==(J=i[22])&&void 0!==J?J:null,domicilioVenta:null!==(O=i[23])&&void 0!==O?O:null,fechaInicio1:"-"!==i[24]?new Date(24*(i[24]-1)*60*60*1e3):void 0,fechaFin1:"-"!==i[25]?new Date(24*(i[25]-1)*60*60*1e3):void 0,fechaInicio2:"-"!==i[26]?new Date(24*(i[26]-1)*60*60*1e3):void 0,fechaFin2:"-"!==i[27]?new Date(24*(i[27]-1)*60*60*1e3):void 0,fechaInicio3:"-"!==i[28]?new Date(24*(i[28]-1)*60*60*1e3):void 0,fechaFin3:"-"!==i[29]?new Date(24*(i[29]-1)*60*60*1e3):void 0,fechaInicio4:"-"!==i[30]?new Date(24*(i[30]-1)*60*60*1e3):void 0,fechaFin4:"-"!==i[31]?new Date(24*(i[31]-1)*60*60*1e3):void 0,fechaInicio5:"-"!==i[32]?new Date(24*(i[32]-1)*60*60*1e3):void 0,fechaFin5:"-"!==i[33]?new Date(24*(i[33]-1)*60*60*1e3):void 0,formaPago:null!==(I=i[34])&&void 0!==I?I:null,datosPago:null!==(E=i[35])&&void 0!==E?E:null,lugarJuntaAclaraciones:null!==(N=i[36])&&void 0!==N?N:null,direccionJuntaAclaracion:null!==(j=i[37])&&void 0!==j?j:null,fechaJuntaAclaraciones:"-"!==i[38]?new Date(24*(i[38]-1)*60*60*1e3):void 0,MontoFiniquitoContrato:null!==(q=i[39])&&void 0!==q?q:null,plazoEjecucion:null!==(Y=i[40])&&void 0!==Y?Y:null,municipio:null!==(R=i[41])&&void 0!==R?R:null,noAfiliado:null!==(Q=i[42])&&void 0!==Q?Q:null,ultimoAnoAfiliacion:null!==(G=i[43])&&void 0!==G?G:null,delegacion:null!==(k=i[44])&&void 0!==k?k:null,esAfiliado:"-"!==i[45],montoAfiliado:null!==(B=i[46])&&void 0!==B?B:null,montoNoAfiliado:null!==(z=i[47])&&void 0!==z?z:null,montoBajo:null!==(H=i[48])&&void 0!==H?H:null,montoAlto:null!==(K=i[49])&&void 0!==K?K:null,lugarGanadorApertura:null!==(W=i[50])&&void 0!==W?W:null,esExtranjera:"-"!==i[51]})}const ne=[];for(let i=0;i<n.licitacionesToCreate.length;i+=100)ne.push(n.licitacionesToCreate.slice(i,i+100));yield n.loading.hide(),yield n.alertMassiveUpload(ne)});return function(u){return c.apply(this,arguments)}}(),a.readAsBinaryString(n.file.uri)}})()}click(o){document.getElementById(o).click()}alertMassiveUpload(o){var n=this;return(0,f.Z)(function*(){var a;yield n.alert.setData({animated:!0,header:"Se van a subir "+n.licitacionesToCreate.length+" licitaciones",message:"Esto puede tomar un tiempo \xbfDesea Continuar?",buttons:[{text:"Cancelar"},{text:"Cargar Licitaciones",handler:(a=(0,f.Z)(function*(){n.loading.setData({animated:!0,message:"Subiendo Licitaciones espere...",spinner:"dots"}),yield n.loading.create(),yield n.loading.show();for(const c of o){const u=yield n.genericService.post("licitaciones/massive",c).toPromise(),r=[...n.licitaciones,...u||[]];n.licitacionRepo.setLicitacion(r)}n.toast.success("Licitaciones Guardadas"),yield n.loading.hide(),n.file=void 0}),function(){return a.apply(this,arguments)})}]})})()}getPagina(o){this.pagina=o,this.licitacionesSelected=this.licitaciones.slice(o*this.divisor,(o+1)*this.divisor)}}return(t=d).\u0275fac=function(o){return new(o||t)(e.Y36(te.X),e.Y36(oe.M),e.Y36(le.c),e.Y36(ce.b),e.Y36(ae._W))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-ver-licitaciones"]],decls:33,vars:11,consts:[[3,"fullscreen"],["color","dark",1,"py-2"],[1,"ms-2","ms-md-5","mb-0","titulo"],[1,"palito","ms-2","ms-md-5","mt-0","mb-3"],["slot","end","shape","round","expand","block",1,"mx-1","mt-2",3,"color","click"],["id","in","type","file","accept",".xls, .cvc, .xlsx",2,"display","none",3,"change"],["slot","end","routerLinkActive","router-link-active","shape","round",1,"mx-1","mt-2",3,"routerLink"],[1,"mt-1","px-3"],[1,"container"],[1,"d-flex","mt-5"],["placeholder","Buscar licitaci\xf3n","inputmode","text","type","text",1,"ms-auto","me-3","my-0","w-100",3,"ngModel","debounce","ngModelChange"],[1,"table","mt-0"],[1,"red"],["scope","col",1,"red"],[4,"ngIf"],[3,"total","divisor","pagina"],[4,"ngFor","ngForOf"],["scope","row",1,"text-center"],["color","primary","slot","start"],["color","primary",3,"routerLink"],["slot","icon-only","name","create-outline"],["color","primary",3,"click"],["slot","icon-only","name","trash-outline"]],template:function(o,n){1&o&&(e.TgZ(0,"ion-content",0),e._UZ(1,"br"),e.TgZ(2,"ion-toolbar",1),e._UZ(3,"br"),e.TgZ(4,"h1",2)(5,"b"),e._uU(6," Licitaciones"),e.qZA()(),e._UZ(7,"hr",3),e.TgZ(8,"ion-button",4),e.NdJ("click",function(){return n.click("in")}),e.TgZ(9,"ion-label"),e._uU(10),e.qZA(),e.TgZ(11,"input",5),e.NdJ("change",function(c){return n.onFileSelected(c)}),e.qZA()(),e.TgZ(12,"ion-button",6),e._uU(13," Crear Licitaci\xf3n "),e.qZA()(),e.TgZ(14,"div",7)(15,"div",8)(16,"div",9),e._UZ(17,"hr"),e.TgZ(18,"ion-searchbar",10),e.NdJ("ngModelChange",function(c){return n.search=c})("ngModelChange",function(){return n.licitacionesSelected=[]}),e.qZA()(),e.TgZ(19,"table",11)(20,"thead",12)(21,"tr")(22,"th",13),e._uU(23,"No. Contrato"),e.qZA(),e.TgZ(24,"th",13),e._uU(25,"No. Procedimiento"),e.qZA(),e.TgZ(26,"th",13),e._uU(27,"Dependencia"),e.qZA(),e.TgZ(28,"th",13),e._uU(29,"Opciones"),e.qZA()()(),e.YNc(30,re,3,4,"tbody",14),e.YNc(31,fe,2,1,"tbody",14),e.qZA(),e.TgZ(32,"paginador",15),e.NdJ("pagina",function(c){return n.getPagina(c)}),e.qZA()()()()),2&o&&(e.Q6J("fullscreen",!0),e.xp6(8),e.Q6J("color",null!=n.file&&n.file.uri?"success":"primary"),e.xp6(2),e.Oqu(null!=n.file&&n.file.uri?"Archivo Cargado":"Subir Licitaciones"),e.xp6(2),e.Q6J("routerLink",e.DdM(10,pe)),e.xp6(6),e.Q6J("ngModel",n.search)("debounce",250),e.xp6(12),e.Q6J("ngIf",0===n.licitacionesSelected.length),e.xp6(1),e.Q6J("ngIf",n.licitacionesSelected.length>0),e.xp6(1),e.Q6J("total",n.licitaciones.length)("divisor",n.divisor))},dependencies:[h.sg,h.O5,v.JJ,v.On,g.YG,g.Sm,g.W2,g.gu,g.Q$,g.VI,g.sr,g.j9,g.YI,p.rH,p.Od,ee.a,de],styles:["ion-searchbar[_ngcontent-%COMP%]{width:250px;border-radius:15px!important;border-start-end-radius:10px}ion-img[_ngcontent-%COMP%]{width:150px}.red[_ngcontent-%COMP%]{background-color:red;color:#fff}"]}),d})()}];let he=(()=>{var t;class d{}return(t=d).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[p.Bz.forChild(me),p.Bz]}),d})();var ve=s(3386);let Ze=(()=>{var t;class d{}return(t=d).\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[h.ez,v.u5,g.Pc,he,ee.a,ve.d]}),d})()}}]);