"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3752],{3752:(dt,I,l)=>{l.r(I),l.d(I,{VerEventoPageModule:()=>lt});var x=l(6814),h=l(95),u=l(9843),p=l(9085),v=l(5861),f=l(1486),G=l(6676),H=l(553),t=l(6689),D=l(8013),Q=l(1284),K=l(4433),z=l(7153),L=l(2425),j=l(930),O=l(7602),B=l(6991);let W=(()=>{var r;class a{transform(o,e){const i=[];if(!e)return o;if(o)for(const c of o)(null==c?void 0:c.titulo.toLowerCase().indexOf(e.toLowerCase()))>-1&&i.push(c);return(0,B.o)(i)}}return(r=a).\u0275fac=function(o){return new(o||r)},r.\u0275pipe=t.Yjl({name:"eventoSearch",type:r,pure:!0}),a})();function X(r,a){if(1&r){const s=t.EpF();t.TgZ(0,"ion-button",18),t.NdJ("click",function(){t.CHM(s);const e=t.oxw().$implicit,i=t.oxw(2);return t.KtG(i.cerrarEvento(e.id))}),t._UZ(1,"ion-icon",26),t.qZA()}}function $(r,a){if(1&r){const s=t.EpF();t.TgZ(0,"ion-button",18),t.NdJ("click",function(){t.CHM(s);const e=t.oxw().$implicit,i=t.oxw(2);return t.KtG(i.reactivar(e.id))}),t._UZ(1,"ion-icon",27),t.qZA()}}function tt(r,a){if(1&r){const s=t.EpF();t.TgZ(0,"tr")(1,"th",15),t._UZ(2,"ion-img",16),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td")(8,"ion-buttons",17)(9,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(s).$implicit,c=t.oxw(2);return t.KtG(c.vistaPrevia(i.id))}),t._UZ(10,"ion-icon",19),t.qZA(),t.TgZ(11,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(s).$implicit,c=t.oxw(2);return t.KtG(c.exportToExcel(i.id))}),t._UZ(12,"ion-icon",20),t.qZA(),t.TgZ(13,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(s).$implicit,c=t.oxw(2);return t.KtG(c.modalUser(i.id))}),t._UZ(14,"ion-icon",21),t.qZA(),t.TgZ(15,"ion-button",22),t._UZ(16,"ion-icon",23),t.qZA(),t.TgZ(17,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(s).$implicit,c=t.oxw(2);return t.KtG(c.deleteEvento(i.id))}),t._UZ(18,"ion-icon",24),t.qZA(),t.YNc(19,X,2,0,"ion-button",25),t.YNc(20,$,2,0,"ion-button",25),t.qZA()()()}if(2&r){const s=a.$implicit,o=t.oxw(2);t.xp6(2),t.Q6J("src",o.uri+s.imagen),t.xp6(2),t.Oqu(s.titulo),t.xp6(2),t.Oqu(o.mon(s.fechaInicio)),t.xp6(9),t.MGl("routerLink","editar-evento/",s.id,""),t.xp6(4),t.Q6J("ngIf",s.active),t.xp6(1),t.Q6J("ngIf",!s.active)}}function et(r,a){if(1&r&&(t.TgZ(0,"tbody"),t.YNc(1,tt,21,6,"tr",14),t.ALo(2,"eventoSearch"),t.qZA()),2&r){const s=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,s.eventos,s.search))}}function nt(r,a){if(1&r){const s=t.EpF();t.TgZ(0,"ion-button",18),t.NdJ("click",function(){t.CHM(s);const e=t.oxw().$implicit,i=t.oxw(2);return t.KtG(i.cerrarEvento(e.id))}),t._UZ(1,"ion-icon",26),t.qZA()}}function ot(r,a){if(1&r){const s=t.EpF();t.TgZ(0,"ion-button",18),t.NdJ("click",function(){t.CHM(s);const e=t.oxw().$implicit,i=t.oxw(2);return t.KtG(i.reactivar(e.id))}),t._UZ(1,"ion-icon",27),t.qZA()}}function it(r,a){if(1&r){const s=t.EpF();t.TgZ(0,"tr")(1,"th",15),t._UZ(2,"ion-img",16),t.qZA(),t.TgZ(3,"td"),t._uU(4),t.qZA(),t.TgZ(5,"td"),t._uU(6),t.qZA(),t.TgZ(7,"td")(8,"ion-buttons",17)(9,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(s).$implicit,c=t.oxw(2);return t.KtG(c.vistaPrevia(i.id))}),t._UZ(10,"ion-icon",19),t.qZA(),t.TgZ(11,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(s).$implicit,c=t.oxw(2);return t.KtG(c.exportToExcel(i.id))}),t._UZ(12,"ion-icon",20),t.qZA(),t.TgZ(13,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(s).$implicit,c=t.oxw(2);return t.KtG(c.modalUser(i.id))}),t._UZ(14,"ion-icon",21),t.qZA(),t.TgZ(15,"ion-button",22),t._UZ(16,"ion-icon",23),t.qZA(),t.TgZ(17,"ion-button",18),t.NdJ("click",function(){const i=t.CHM(s).$implicit,c=t.oxw(2);return t.KtG(c.deleteEvento(i.id))}),t._UZ(18,"ion-icon",24),t.qZA(),t.YNc(19,nt,2,0,"ion-button",25),t.YNc(20,ot,2,0,"ion-button",25),t.qZA()()()}if(2&r){const s=a.$implicit,o=t.oxw(2);t.xp6(2),t.Q6J("src",o.uri+s.imagen),t.xp6(2),t.Oqu(s.titulo),t.xp6(2),t.Oqu(o.mon(s.fechaInicio)),t.xp6(9),t.MGl("routerLink","editar-evento/",s.id,""),t.xp6(4),t.Q6J("ngIf",s.active),t.xp6(1),t.Q6J("ngIf",!s.active)}}function rt(r,a){if(1&r&&(t.TgZ(0,"tbody"),t.YNc(1,it,21,6,"tr",14),t.qZA()),2&r){const s=t.oxw();t.xp6(1),t.Q6J("ngForOf",s.eventosSelected)}}const st=[{path:"",component:(()=>{var r;class a{constructor(o,e,i,c,d,m,g){this.eventoRepo=o,this.boletosRepo=e,this.nav=i,this.alert=c,this.loading=d,this.toast=m,this.genericService=g,this.uri=H.N.image+"eventos/",this.eventos=[],this.eventosSelected=[],this.divisor=10}ngOnInit(){this.eventoRepo.evento$.subscribe(o=>{this.eventos=o.sort((e,i)=>new Date(i.fechaInicio).getTime()-new Date(e.fechaInicio).getTime()),this.eventosSelected=o.slice(0,this.divisor)})}mon(o){return G(o).locale("es").format("L")+" "+G(new Date(o)).utc().format("LTS")}vistaPrevia(o){var e=this;return(0,v.Z)(function*(){const i=e.eventos.find(c=>c.id===o);i&&window.open(H.N.host+"evento/"+i.identificador,"_blank")})()}exportToExcel(o){const e=this.eventos.find(n=>n.id===o);let i=[];for(let n of null==e?void 0:e.boletos){var c,d,m,g,_,Z,y,E,T,C,P,b,A,V,U,J,M,N,w,F,S,k,q,Y;i.push({Folio:n.folio,Nombre:n.afiliado?null==n||null===(c=n.afiliado)||void 0===c?void 0:c.nombre:null!==(d=null==n||null===(m=n.participante)||void 0===m?void 0:m.nombre)&&void 0!==d?d:"",Cargo:n.afiliado?null==n||null===(g=n.afiliado)||void 0===g?void 0:g.cargo:null!==(_=null==n||null===(Z=n.participante)||void 0===Z?void 0:Z.cargo)&&void 0!==_?_:"",Empresa:n.afiliado?null==n||null===(y=n.afiliado)||void 0===y?void 0:y.empresa:null!==(E=null==n||null===(T=n.participante)||void 0===T?void 0:T.empresa)&&void 0!==E?E:"",Organizaci\u00f3n:n.afiliado?null==n||null===(C=n.afiliado)||void 0===C?void 0:C.organizacion:null!==(P=null==n||null===(b=n.participante)||void 0===b?void 0:b.organizacion)&&void 0!==P?P:"",Correo:n.afiliado?null==n||null===(A=n.afiliado)||void 0===A?void 0:A.email:null!==(V=null==n||null===(U=n.participante)||void 0===U?void 0:U.email)&&void 0!==V?V:"",Tel\u00e9fono:n.afiliado?null==n||null===(J=n.afiliado)||void 0===J?void 0:J.telefono:null!==(M=null==n||null===(N=n.participante)||void 0===N?void 0:N.telefono)&&void 0!==M?M:"","Tipo Asistencia":null!==(w=n.privilegio)&&void 0!==w?w:"N/A","Forma de Pago":n.idPago?"Tarjeta de cr\xe9dito":"Transferencia","Boleto Pagado":n.active?"Si":"No","Necesita Factura":n.quieroFactura?"Si":"No",RFC:n.afiliado?null==n||null===(F=n.afiliado)||void 0===F?void 0:F.rfc:null!==(S=null==n||null===(k=n.participante)||void 0===k?void 0:k.rfc)&&void 0!==S?S:"",CURP:null!==(q=null==n||null===(Y=n.participante)||void 0===Y?void 0:Y.curp)&&void 0!==q?q:""})}if(i){const n=f.P6.json_to_sheet(i),R=f.P6.book_new();f.P6.book_append_sheet(R,n,"Sheet1"),f.NC(R,(null==e?void 0:e.titulo.toUpperCase())+".xlsx")}}modalUser(o){var e=this;return(0,v.Z)(function*(){const i=e.eventos.find(c=>c.id===o);i&&(e.boletosRepo.setEventos(i.boletos),e.nav.navigateForward("dashboard/eventos/ver-usuarios",{queryParams:{id:o}}))})()}deleteEvento(o){var e=this;return(0,v.Z)(function*(){var i;yield e.alert.setData({animated:!0,header:"Est\xe1 a punto de eliminar este evento",message:"Si lo elimina se perder\xe1n todos los datos relacionados. \n \xbfDesea continuar?",buttons:[{text:"Cancelar"},{text:"Confirmar",handler:(i=(0,v.Z)(function*(){e.loading.setData({animated:!0,message:"Eliminando",spinner:"dots"}),yield e.loading.create(),yield e.loading.show(),e.genericService.delete("evento",o).subscribe(function(){var c=(0,v.Z)(function*(d){yield e.loading.hide(),e.toast.success("Evento Eliminado"),e.eventoRepo.deleteEvento(o)});return function(d){return c.apply(this,arguments)}}())}),function(){return i.apply(this,arguments)})}]})})()}cerrarEvento(o){var e=this;return(0,v.Z)(function*(){var i;yield e.alert.setData({animated:!0,header:"Cerrar Evento",message:"Est\xe1 a punto de cerrar el evento una vez lo haga no podr\xe1 reabrilo \xbfDesea Continuar?",inputs:[{name:"titulo",type:"text",placeholder:"Ingrese Titulo"},{name:"descripcion",type:"textarea",placeholder:"Ingrese texto "}],buttons:[{text:"Cancelar"},{text:"Cerrar",handler:(i=(0,v.Z)(function*(c){yield e.loading.setData({animated:!0,message:"Cerrando Evento..."}),yield e.loading.create(),yield e.loading.show(),e.genericService.update("evento",o,{active:!1,modal:{titulo:c.titulo,descripcion:c.descripcion}}).subscribe(function(){var m=(0,v.Z)(function*(g){e.eventos=e.eventos.map(_=>_.id===o?g:_),yield e.loading.hide(),e.toast.success("Evento Cerrado","Correcto")});return function(g){return m.apply(this,arguments)}}())}),function(d){return i.apply(this,arguments)})}]})})()}reactivar(o){var e=this;return(0,v.Z)(function*(){var i;yield e.alert.setData({animated:!0,header:"Reactivar Evento",message:"Est\xe1 a punto de reactivar el evento le recomendamos editar el evento antes de hacerlo \xbfDesea Continuar?",buttons:[{text:"Cancelar"},{text:"Reactivar",handler:(i=(0,v.Z)(function*(){yield e.loading.setData({animated:!0,message:"Cerrando Evento..."}),yield e.loading.create(),yield e.loading.show(),e.genericService.update("evento",o,{active:!0,modal:null}).subscribe(function(){var c=(0,v.Z)(function*(d){e.eventos=e.eventos.map(m=>m.id===o?d:m),yield e.loading.hide(),e.toast.success("Evento Reactivado","Correcto")});return function(d){return c.apply(this,arguments)}}())}),function(){return i.apply(this,arguments)})}]})})()}getPagina(o){this.eventosSelected=this.eventos.slice(o*this.divisor,(o+1)*this.divisor)}}return(r=a).\u0275fac=function(o){return new(o||r)(t.Y36(D.hJ),t.Y36(Q.b9),t.Y36(u.SH),t.Y36(K.c),t.Y36(z.b),t.Y36(L._W),t.Y36(j.M))},r.\u0275cmp=t.Xpm({type:r,selectors:[["app-ver-evento"]],decls:27,vars:7,consts:[[3,"fullscreen"],["color","dark",1,"mt-4","py-2"],[1,"ms-2","ms-md-5","mb-0","titulo"],[1,"palito","ms-2","ms-md-5","mt-0","mb-3"],[1,"mt-2","px-3"],[1,"container"],[1,"d-flex","mt-1"],["placeholder","Buscar evento","inputmode","text","type","text",1,"ms-auto","me-3","my-0","w-100",3,"ngModel","debounce","ngModelChange"],[1,"table","mt-0"],[1,"red"],["scope","col",1,"red","d-none","d-md-block"],["scope","col",1,"red"],[4,"ngIf"],[3,"total","divisor","pagina"],[4,"ngFor","ngForOf"],["scope","row",1,"text-center","d-none","d-md-block"],[1,"img-fluid",3,"src"],["color","primary","slot","start"],["color","primary",3,"click"],["slot","icon-only","name","eye-outline"],["slot","icon-only","name","download-outline"],["slot","icon-only","name","people-outline"],["color","primary",3,"routerLink"],["slot","icon-only","name","create-outline"],["slot","icon-only","name","trash-outline"],["color","primary",3,"click",4,"ngIf"],["slot","icon-only","name","close-outline"],["slot","icon-only","name","power-outline"]],template:function(o,e){1&o&&(t.TgZ(0,"ion-content",0)(1,"ion-toolbar",1),t._UZ(2,"br"),t.TgZ(3,"h1",2)(4,"b"),t._uU(5,"Eventos Registrados"),t.qZA()(),t._UZ(6,"hr",3),t.qZA(),t._UZ(7,"br")(8,"br"),t.TgZ(9,"div",4)(10,"div",5)(11,"div",6)(12,"ion-searchbar",7),t.NdJ("ngModelChange",function(){return e.eventosSelected=[]})("ngModelChange",function(c){return e.search=c}),t.qZA()(),t.TgZ(13,"table",8)(14,"thead",9)(15,"tr")(16,"th",10),t._uU(17,"Foto"),t.qZA(),t.TgZ(18,"th",11),t._uU(19,"Nombre"),t.qZA(),t.TgZ(20,"th",11),t._uU(21,"Dia y Hora"),t.qZA(),t.TgZ(22,"th",11),t._uU(23,"Opciones"),t.qZA()()(),t.YNc(24,et,3,4,"tbody",12),t.YNc(25,rt,2,1,"tbody",12),t.qZA()()(),t.TgZ(26,"paginador",13),t.NdJ("pagina",function(c){return e.getPagina(c)}),t.qZA()()),2&o&&(t.Q6J("fullscreen",!0),t.xp6(12),t.Q6J("ngModel",e.search)("debounce",250),t.xp6(12),t.Q6J("ngIf",0==e.eventosSelected.length),t.xp6(1),t.Q6J("ngIf",e.eventosSelected.length>0),t.xp6(1),t.Q6J("total",e.eventos.length)("divisor",e.divisor))},dependencies:[x.sg,x.O5,h.JJ,h.On,u.YG,u.Sm,u.W2,u.gu,u.Xz,u.VI,u.sr,u.j9,u.YI,p.rH,O.a,W],styles:[".red[_ngcontent-%COMP%]{background-color:var(--ion-color-primary);color:#fff}.img-fluid[_ngcontent-%COMP%]{max-width:100px}"]}),a})()}];let ct=(()=>{var r;class a{}return(r=a).\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[p.Bz.forChild(st),p.Bz]}),a})();var at=l(3386);let lt=(()=>{var r;class a{}return(r=a).\u0275fac=function(o){return new(o||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[x.ez,h.u5,u.Pc,ct,O.a,at.d]}),a})()}}]);