"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3923],{3923:(U,y,a)=>{a.r(y),a.d(y,{CrearApoyoPageModule:()=>Y});var v=a(6814),c=a(95),d=a(9843),g=a(9085),m=a(5861),p=a(8915),h=a(4664),A=a(553),o=a(6689),b=a(930),C=a(2264),Z=a(7153),x=a(2425),P=a(2051);function J(t,l){if(1&t){const s=o.EpF();o.TgZ(0,"ion-button",14),o.NdJ("click",function(){o.CHM(s);const r=o.oxw();return o.KtG(r.save())}),o._uU(1," Crear "),o.qZA()}if(2&t){const s=o.oxw();o.Q6J("disabled",s.form.invalid)}}function T(t,l){if(1&t){const s=o.EpF();o.TgZ(0,"ion-button",14),o.NdJ("click",function(){o.CHM(s);const r=o.oxw();return o.KtG(r.update())}),o._uU(1," Guardar Cambios "),o.qZA()}if(2&t){const s=o.oxw();o.Q6J("disabled",s.form.invalid)}}const I=[{path:"",component:(()=>{var t;class l{constructor(e,r,i,u,n,f,F,N){this.gService=e,this.compress=r,this.fb=i,this.load=u,this.toast=n,this.params=f,this.apoyosR=F,this.nav=N,this.toolbar=[[{heading:["h1","h2","h3","h4","h5","h6"]}],["bold","italic"],["underline","strike"],["ordered_list","bullet_list"],["align_left","align_center","align_right","align_justify"],["horizontal_rule","format_clear"],["text_color","background_color"]],this.uri=A.N.image+"apoyos-dn/"}ngOnInit(){var e=this;this.form=this.fb.group({titulo:[null,p.kI.required],descripcion:[null,p.kI.required]}),this.editor=new p.ML,this.params.params.pipe((0,h.w)(r=>{var i;return this.identificador=Number(null!==(i=null==r?void 0:r.identificador)&&void 0!==i?i:0),this.apoyosR.user$})).subscribe(function(){var r=(0,m.Z)(function*(i){if(0!==e.identificador){const u=i.find(n=>n.id===e.identificador);e.form.setValue({titulo:u.titulo,descripcion:u.descripcion}),e.imagen=e.uri+u.imagen}});return function(i){return r.apply(this,arguments)}}())}getImage(){var e=this;return(0,m.Z)(function*(){e.imagen=yield e.compress.returnImageCompress()})()}save(){var e=this;return(0,m.Z)(function*(){let r;yield e.load.setData({animated:!0,spinner:"dots",translucent:!0,message:"Creando Apoyo..."}),yield e.load.create(),yield e.load.show(),r="string"!=typeof e.form.controls.descripcion.value?(0,p.io)(e.form.controls.descripcion.value):e.form.controls.descripcion.value,e.form.controls.descripcion.setValue(r);const i=new FormData;for(const n in e.form.value)e.form.value.hasOwnProperty(n)&&"costos"!==n&&i.append(n,e.form.value[n]);e.imagen&&i.append("imagen",e.compress.dataURItoBlob(e.imagen));const u=e.form.controls.titulo.value.replace(/ /g,"-");i.append("identificador",u.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()),e.gService.postWhitImage("desastres",i).subscribe(function(){var n=(0,m.Z)(function*(f){e.imagen=null,e.form.reset({}),yield e.load.hide(),e.toast.success("Apoyo Guardado")});return function(f){return n.apply(this,arguments)}}())})()}update(){var e=this;return(0,m.Z)(function*(){let r;yield e.load.setData({animated:!0,spinner:"dots",translucent:!0,message:"Guardando Cambios..."}),yield e.load.create(),yield e.load.show(),r="string"!=typeof e.form.controls.descripcion.value?(0,p.io)(e.form.controls.descripcion.value):e.form.controls.descripcion.value,e.form.controls.descripcion.setValue(r);const i=new FormData;for(const n in e.form.value)e.form.value.hasOwnProperty(n)&&"imagen"!==n&&i.append(n,e.form.value[n]);e.imagen.includes("data:")&&i.append("imagen",e.compress.dataURItoBlob(e.imagen));const u=e.form.controls.titulo.value.replace(/ /g,"-");i.append("identificador",u.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()),e.gService.updateWhitImage("desastres",e.identificador,i).subscribe(function(){var n=(0,m.Z)(function*(f){e.imagen=null,e.form.reset({}),yield e.load.hide(),e.apoyosR.updateApoyo(e.identificador,f),e.toast.success("Apoyo Guardado"),e.nav.navigateForward("/dashboard/apoyos")});return function(f){return n.apply(this,arguments)}}())})()}}return(t=l).\u0275fac=function(e){return new(e||t)(o.Y36(b.M),o.Y36(C.Y),o.Y36(c.qu),o.Y36(Z.b),o.Y36(x._W),o.Y36(g.gz),o.Y36(P.d),o.Y36(d.SH))},t.\u0275cmp=o.Xpm({type:t,selectors:[["app-crear-apoyo"]],decls:22,vars:10,consts:[[3,"fullscreen"],[1,"mt-5","px-4"],[1,"container"],[1,"my-3"],[3,"formGroup"],["lines","none",1,"ion-margin-vertical"],["label","Titulo","labelPlacement","floating","required","","formControlName","titulo","type","text"],["button","","lines","none",1,"ion-margin-vertical",3,"click"],["slot","start","color","primary"],["slot","end",2,"max-width","300px",3,"src"],[1,"NgxEditor__Wrapper"],[3,"toolbar","editor"],["formControlName","descripcion",3,"editor","placeholder"],["expand","block","class","my-3","shape","round","color","primary",3,"disabled","click",4,"ngIf"],["expand","block","shape","round","color","primary",1,"my-3",3,"disabled","click"]],template:function(e,r){1&e&&(o.TgZ(0,"ion-content",0),o._UZ(1,"br")(2,"br"),o.TgZ(3,"div",1)(4,"div",2)(5,"h1",3)(6,"b"),o._uU(7),o.qZA()()()(),o.TgZ(8,"div",2)(9,"form",4)(10,"ion-item",5),o._UZ(11,"ion-input",6),o.qZA(),o.TgZ(12,"ion-item",7),o.NdJ("click",function(){return r.getImage()}),o.TgZ(13,"ion-text",8)(14,"h5"),o._uU(15,"Subir Imagen"),o.qZA()(),o._UZ(16,"ion-img",9),o.qZA(),o.TgZ(17,"div",10),o._UZ(18,"ngx-editor-menu",11)(19,"ngx-editor",12),o.qZA(),o.YNc(20,J,2,1,"ion-button",13),o.YNc(21,T,2,1,"ion-button",13),o.qZA()()()),2&e&&(o.Q6J("fullscreen",!0),o.xp6(7),o.hij(" ",0!==r.identificador?"Editar Apoyo":"Crear Apoyo",""),o.xp6(2),o.Q6J("formGroup",r.form),o.xp6(7),o.Q6J("src",r.imagen),o.xp6(2),o.Q6J("toolbar",r.toolbar)("editor",r.editor),o.xp6(1),o.Q6J("editor",r.editor)("placeholder","Descripci\xf3n del evento"),o.xp6(1),o.Q6J("ngIf",0===r.identificador||!r.identificador),o.xp6(1),o.Q6J("ngIf",0!==r.identificador))},dependencies:[v.O5,c._Y,c.JJ,c.JL,c.Q7,c.sg,c.u,d.YG,d.W2,d.Xz,d.pK,d.Ie,d.yW,d.j9,p.tP,p.Mn]}),l})()}];let M=(()=>{var t;class l{}return(t=l).\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[g.Bz.forChild(I),g.Bz]}),l})(),Y=(()=>{var t;class l{}return(t=l).\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.oAB({type:t}),t.\u0275inj=o.cJS({imports:[v.ez,c.u5,c.UX,d.Pc,M,p.FP]}),l})()}}]);