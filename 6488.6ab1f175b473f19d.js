"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6488],{6488:(L,m,i)=>{i.r(m),i.d(m,{LoginPageModule:()=>S});var v=i(6814),r=i(95),a=i(7027),p=i(9085),c=i(5861),h=i(6726),d=i(553),f=i(6676),o=i(6689),y=i(7763),P=i(2425);const b=[{path:"",component:(()=>{var n;class u{constructor(e,t,s,l,w){this.fb=e,this.genericS=t,this.router=s,this.toast=l,this.loading=w,this.visible=!1}ngOnInit(){this.loginForm=this.fb.group({email:[null,[r.kI.required]],password:[null,r.kI.required]}),localStorage.getItem(d.N.jwt)&&this.valid()}login(){var e=this;return(0,c.Z)(function*(){const t=yield e.loading.create({animated:!0,spinner:"dots",translucent:!0,message:"Iniciando Sesi\xf3n..."});yield t.present(),e.genericS.post("user/login",e.loginForm.value).subscribe(function(){var s=(0,c.Z)(function*(l){localStorage.setItem(d.N.user,l.user.id),localStorage.setItem(d.N.jwt,l.jwt),yield t.dismiss(),e.toast.success(`Bienvenido: ${l.user.names}`),e.router.navigateForward("/dashboard")});return function(l){return s.apply(this,arguments)}}(),function(){var s=(0,c.Z)(function*(l){yield t.dismiss(),e.toast.warning(l.error.message,"Error",{positionClass:"toast-top-right"})});return function(l){return s.apply(this,arguments)}}())})()}valid(){var e=this;return(0,c.Z)(function*(){const t=yield e.loading.create({animated:!0,spinner:"dots",translucent:!0,message:"Iniciando Sesi\xf3n..."});yield t.present();const s=(0,h.Z)(localStorage.getItem(d.N.jwt)||"");f(1e3*s.exp)<f()?(console.log("entree "),localStorage.clear(),yield t.dismiss(),e.toast.error("Sesi\xf3n Cerrada","Vuelva a Iniciar Sesi\xf3n")):(yield t.dismiss(),e.router.navigateForward("/dashboard"))})()}}return(n=u).\u0275fac=function(e){return new(e||n)(o.Y36(r.qu),o.Y36(y.M),o.Y36(a.SH),o.Y36(P._W),o.Y36(a.HT))},n.\u0275cmp=o.Xpm({type:n,selectors:[["app-login"]],decls:21,vars:5,consts:[[3,"fullscreen"],[1,"h-100","d-flex","fondo"],["mode","ios","color","ligth",1,"m-auto","text-center","shadow",2,"background-color","white"],["src","https://www.cmiccdmx.org/wp-content/uploads/2021/08/logo-cmic.png","width","250px","alt","",1,"ion-margin","ion-padding"],[1,"text-center",3,"formGroup","ngSubmit"],["color","ligth",1,"p-3","pe-3","rounded","ion-margin-vertical"],["labelPlacement","floating","required","","formControlName","email","type","text"],["slot","label"],["color","danger"],["labelPlacement","floating","required","","formControlName","password",3,"type"],["slot","end","fill","clear","color","dark",1,"my-auto",3,"click"],["slot","icon-only",3,"name"],["expand","block","shape","round","color","primary","type","submit",1,"ion-padding-horizontal","ion-margin-vertical",3,"disabled"]],template:function(e,t){1&e&&(o.TgZ(0,"ion-content",0)(1,"div",1)(2,"ion-card",2),o._UZ(3,"img",3),o.TgZ(4,"form",4),o.NdJ("ngSubmit",function(){return t.login()}),o.TgZ(5,"ion-item",5)(6,"ion-input",6)(7,"div",7),o._uU(8,"Usuario "),o.TgZ(9,"ion-text",8),o._uU(10,"*"),o.qZA()()()(),o.TgZ(11,"ion-item",5)(12,"ion-input",9)(13,"div",7),o._uU(14,"Contrase\xf1a "),o.TgZ(15,"ion-text",8),o._uU(16,"*"),o.qZA()()(),o.TgZ(17,"ion-button",10),o.NdJ("click",function(){return t.visible=!t.visible}),o._UZ(18,"ion-icon",11),o.qZA()(),o.TgZ(19,"ion-button",12),o._uU(20," Iniciar Sesi\xf3n "),o.qZA()()()()()),2&e&&(o.Q6J("fullscreen",!0),o.xp6(4),o.Q6J("formGroup",t.loginForm),o.xp6(8),o.Q6J("type",t.visible?"text":"password"),o.xp6(6),o.Q6J("name",t.visible?"eye-off-outline":"eye-outline"),o.xp6(1),o.Q6J("disabled",t.loginForm.invalid))},dependencies:[r._Y,r.JJ,r.JL,r.Q7,r.sg,r.u,a.YG,a.PM,a.W2,a.gu,a.pK,a.Ie,a.yW,a.j9],styles:[".fondo[_ngcontent-%COMP%]{background-image:url(https://www.cmic.org.mx/sectores/comunicacion/noticias/fotografias/Fachada%20CMIC%20800.jpg);background-repeat:no-repeat;background-size:cover}.rounded[_ngcontent-%COMP%]{border-radius:10px}"]}),u})()}];let Z=(()=>{var n;class u{}return(n=u).\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[p.Bz.forChild(b),p.Bz]}),u})(),S=(()=>{var n;class u{}return(n=u).\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.oAB({type:n}),n.\u0275inj=o.cJS({imports:[v.ez,r.u5,r.UX,a.Pc,Z]}),u})()}}]);